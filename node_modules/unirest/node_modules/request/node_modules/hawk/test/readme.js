// Load modules

var Lab = require('lab'***REMOVED***;
var Hoek = require('hoek'***REMOVED***;
var Hawk = require('../lib'***REMOVED***;


// Declare internals

var internals = {};


// Test shortcuts

var expect = Lab.expect;
var before = Lab.before;
var after = Lab.after;
var describe = Lab.experiment;
var it = Lab.test;


describe('Hawk', function (***REMOVED*** {

    describe('README', function (***REMOVED*** {

        describe('core', function (***REMOVED*** {

            var credentials = {
                id: 'dh37fgj492je',
                key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',
                algorithm: 'sha256'
          ***REMOVED***;

            var options = {
                credentials: credentials,
                timestamp: 1353832234,
                nonce: 'j4h3g2',
                ext: 'some-app-ext-data'
          ***REMOVED***;

            it('should generate a header protocol example', function (done***REMOVED*** {

                var header = Hawk.client.header('http://example.com:8000/resource/1?b=1&a=2', 'GET', options***REMOVED***.field;

                expect(header***REMOVED***.to.equal('Hawk id="dh37fgj492je", ts="1353832234", nonce="j4h3g2", ext="some-app-ext-data", mac="6R4rV5iE+NPoym+WwjeHzjAGXUtLNIxmo1vpMofpLAE="'***REMOVED***;
                done(***REMOVED***;
          ***REMOVED******REMOVED***;

            it('should generate a normalized string protocol example', function (done***REMOVED*** {

                var normalized = Hawk.crypto.generateNormalizedString('header', {
                    credentials: credentials,
                    ts: options.timestamp,
                    nonce: options.nonce,
                    method: 'GET',
                    resource: '/resource?a=1&b=2',
                    host: 'example.com',
                    port: 8000,
                    ext: options.ext
              ***REMOVED******REMOVED***;

                expect(normalized***REMOVED***.to.equal('hawk.1.header\n1353832234\nj4h3g2\nGET\n/resource?a=1&b=2\nexample.com\n8000\n\nsome-app-ext-data\n'***REMOVED***;
                done(***REMOVED***;
          ***REMOVED******REMOVED***;

            var payloadOptions = Hoek.clone(options***REMOVED***;
            payloadOptions.payload = 'Thank you for flying Hawk';
            payloadOptions.contentType = 'text/plain';

            it('should generate a header protocol example (with payload***REMOVED***', function (done***REMOVED*** {

                var header = Hawk.client.header('http://example.com:8000/resource/1?b=1&a=2', 'POST', payloadOptions***REMOVED***.field;

                expect(header***REMOVED***.to.equal('Hawk id="dh37fgj492je", ts="1353832234", nonce="j4h3g2", hash="Yi9LfIIFRtBEPt74PVmbTF/xVAwPn7ub15ePICfgnuY=", ext="some-app-ext-data", mac="aSe1DERmZuRl3pI36/9BdZmnErTw3sNzOOAUlfeKjVw="'***REMOVED***;
                done(***REMOVED***;
          ***REMOVED******REMOVED***;

            it('should generate a normalized string protocol example (with payload***REMOVED***', function (done***REMOVED*** {

                var normalized = Hawk.crypto.generateNormalizedString('header', {
                    credentials: credentials,
                    ts: options.timestamp,
                    nonce: options.nonce,
                    method: 'POST',
                    resource: '/resource?a=1&b=2',
                    host: 'example.com',
                    port: 8000,
                    hash: Hawk.crypto.calculatePayloadHash(payloadOptions.payload, credentials.algorithm, payloadOptions.contentType***REMOVED***,
                    ext: options.ext
              ***REMOVED******REMOVED***;

                expect(normalized***REMOVED***.to.equal('hawk.1.header\n1353832234\nj4h3g2\nPOST\n/resource?a=1&b=2\nexample.com\n8000\nYi9LfIIFRtBEPt74PVmbTF/xVAwPn7ub15ePICfgnuY=\nsome-app-ext-data\n'***REMOVED***;
                done(***REMOVED***;
          ***REMOVED******REMOVED***;
      ***REMOVED******REMOVED***;
  ***REMOVED******REMOVED***;
}***REMOVED***;

