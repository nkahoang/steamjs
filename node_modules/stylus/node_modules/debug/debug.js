
/**
 * Expose `debug(***REMOVED***` as the module.
 */

module.exports = debug;

/**
 * Create a debugger with the given `name`.
 *
 * @param {String} name
 * @return {Type}
 * @api public
 */

function debug(name***REMOVED*** {
  if (!debug.enabled(name***REMOVED******REMOVED*** return function(***REMOVED***{};

  return function(fmt***REMOVED***{
    fmt = coerce(fmt***REMOVED***;

    var curr = new Date;
    var ms = curr - (debug[name] || curr***REMOVED***;
    debug[name] = curr;

    fmt = name
      + ' '
      + fmt
      + ' +' + debug.humanize(ms***REMOVED***;

    // This hackery is required for IE8
    // where `console.log` doesn't have 'apply'
    window.console
      && console.log
      && Function.prototype.apply.call(console.log, console, arguments***REMOVED***;
***REMOVED***
}

/**
 * The currently active debug mode names.
 */

debug.names = [];
debug.skips = [];

/**
 * Enables a debug mode by name. This can include modes
 * separated by a colon and wildcards.
 *
 * @param {String} name
 * @api public
 */

debug.enable = function(name***REMOVED*** {
  try {
    localStorage.debug = name;
***REMOVED*** catch(e***REMOVED***{}

  var split = (name || ''***REMOVED***.split(/[\s,]+/***REMOVED***
    , len = split.length;

  for (var i = 0; i < len; i++***REMOVED*** {
    name = split[i].replace('*', '.*?'***REMOVED***;
    if (name[0] === '-'***REMOVED*** {
      debug.skips.push(new RegExp('^' + name.substr(1***REMOVED*** + '$'***REMOVED******REMOVED***;
  ***REMOVED***
    else {
      debug.names.push(new RegExp('^' + name + '$'***REMOVED******REMOVED***;
  ***REMOVED***
***REMOVED***
};

/**
 * Disable debug output.
 *
 * @api public
 */

debug.disable = function(***REMOVED***{
  debug.enable(''***REMOVED***;
};

/**
 * Humanize the given `ms`.
 *
 * @param {Number} m
 * @return {String}
 * @api private
 */

debug.humanize = function(ms***REMOVED*** {
  var sec = 1000
    , min = 60 * 1000
    , hour = 60 * min;

  if (ms >= hour***REMOVED*** return (ms / hour***REMOVED***.toFixed(1***REMOVED*** + 'h';
  if (ms >= min***REMOVED*** return (ms / min***REMOVED***.toFixed(1***REMOVED*** + 'm';
  if (ms >= sec***REMOVED*** return (ms / sec | 0***REMOVED*** + 's';
  return ms + 'ms';
};

/**
 * Returns true if the given mode name is enabled, false otherwise.
 *
 * @param {String} name
 * @return {Boolean}
 * @api public
 */

debug.enabled = function(name***REMOVED*** {
  for (var i = 0, len = debug.skips.length; i < len; i++***REMOVED*** {
    if (debug.skips[i].test(name***REMOVED******REMOVED*** {
      return false;
  ***REMOVED***
***REMOVED***
  for (var i = 0, len = debug.names.length; i < len; i++***REMOVED*** {
    if (debug.names[i].test(name***REMOVED******REMOVED*** {
      return true;
  ***REMOVED***
***REMOVED***
  return false;
};

/**
 * Coerce `val`.
 */

function coerce(val***REMOVED*** {
  if (val instanceof Error***REMOVED*** return val.stack || val.message;
  return val;
}

// persist

try {
  if (window.localStorage***REMOVED*** debug.enable(localStorage.debug***REMOVED***;
} catch(e***REMOVED***{}
