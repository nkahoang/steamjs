
var fs = require("fs"***REMOVED***,
  util = require("util"***REMOVED***,
  path = require("path"***REMOVED***,
  xml = fs.readFileSync(path.join(__dirname, "test.xml"***REMOVED***, "utf8"***REMOVED***,
  sax = require("../lib/sax"***REMOVED***,
  strict = sax.parser(true***REMOVED***,
  loose = sax.parser(false, {trim:true}***REMOVED***,
  inspector = function (ev***REMOVED*** { return function (data***REMOVED*** {
    console.error("%s %s %j", this.line+":"+this.column, ev, data***REMOVED***;
***REMOVED***};

sax.EVENTS.forEach(function (ev***REMOVED*** {
  loose["on"+ev] = inspector(ev***REMOVED***;
}***REMOVED***;
loose.onend = function (***REMOVED*** {
  console.error("end"***REMOVED***;
  console.error(loose***REMOVED***;
};

// do this in random bits at a time to verify that it works.
(function (***REMOVED*** {
  if (xml***REMOVED*** {
    var c = Math.ceil(Math.random(***REMOVED*** * 1000***REMOVED***
    loose.write(xml.substr(0,c***REMOVED******REMOVED***;
    xml = xml.substr(c***REMOVED***;
    process.nextTick(arguments.callee***REMOVED***;
***REMOVED*** else loose.close(***REMOVED***;
}***REMOVED***(***REMOVED***;
