/**
 * Lo-Dash 2.4.1 (Custom Build***REMOVED*** <http://lodash.com/>
 * Build: `lodash modularize modern exports="node" -o ./modern/`
 * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>
 * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>
 * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 * Available under MIT license <http://lodash.com/license>
 */
var baseCreate = require('./baseCreate'***REMOVED***,
    isObject = require('../objects/isObject'***REMOVED***,
    setBindData = require('./setBindData'***REMOVED***,
    slice = require('./slice'***REMOVED***;

/**
 * Used for `Array` method references.
 *
 * Normally `Array.prototype` would suffice, however, using an array literal
 * avoids issues in Narwhal.
 */
var arrayRef = [];

/** Native method shortcuts */
var push = arrayRef.push;

/**
 * The base implementation of `createWrapper` that creates the wrapper and
 * sets its meta data.
 *
 * @private
 * @param {Array} bindData The bind data array.
 * @returns {Function} Returns the new function.
 */
function baseCreateWrapper(bindData***REMOVED*** {
  var func = bindData[0],
      bitmask = bindData[1],
      partialArgs = bindData[2],
      partialRightArgs = bindData[3],
      thisArg = bindData[4],
      arity = bindData[5];

  var isBind = bitmask & 1,
      isBindKey = bitmask & 2,
      isCurry = bitmask & 4,
      isCurryBound = bitmask & 8,
      key = func;

  function bound(***REMOVED*** {
    var thisBinding = isBind ? thisArg : this;
    if (partialArgs***REMOVED*** {
      var args = slice(partialArgs***REMOVED***;
      push.apply(args, arguments***REMOVED***;
  ***REMOVED***
    if (partialRightArgs || isCurry***REMOVED*** {
      args || (args = slice(arguments***REMOVED******REMOVED***;
      if (partialRightArgs***REMOVED*** {
        push.apply(args, partialRightArgs***REMOVED***;
    ***REMOVED***
      if (isCurry && args.length < arity***REMOVED*** {
        bitmask |= 16 & ~32;
        return baseCreateWrapper([func, (isCurryBound ? bitmask : bitmask & ~3***REMOVED***, args, null, thisArg, arity]***REMOVED***;
    ***REMOVED***
  ***REMOVED***
    args || (args = arguments***REMOVED***;
    if (isBindKey***REMOVED*** {
      func = thisBinding[key];
  ***REMOVED***
    if (this instanceof bound***REMOVED*** {
      thisBinding = baseCreate(func.prototype***REMOVED***;
      var result = func.apply(thisBinding, args***REMOVED***;
      return isObject(result***REMOVED*** ? result : thisBinding;
  ***REMOVED***
    return func.apply(thisBinding, args***REMOVED***;
***REMOVED***
  setBindData(bound, bindData***REMOVED***;
  return bound;
}

module.exports = baseCreateWrapper;
