module.exports = Negotiator;
Negotiator.Negotiator = Negotiator;

function Negotiator(request***REMOVED*** {
  if (!(this instanceof Negotiator***REMOVED******REMOVED*** return new Negotiator(request***REMOVED***;
  this.request = request;
}

var set = { preferredCharset: [require('./charset.js'***REMOVED***, 'accept-charset'],
            preferredEncoding: [require('./encoding.js'***REMOVED***, 'accept-encoding'],
            preferredLanguage: [require('./language.js'***REMOVED***, 'accept-language'],
            preferredMediaType: [require('./mediaType.js'***REMOVED***, 'accept'] };

Object.keys(set***REMOVED***.forEach(function (k***REMOVED*** {
  var mh = set[k],
      method = mh[0],
      header = mh[1],
      singular = k,
      plural = k + 's';

  Negotiator.prototype[plural] = function (available***REMOVED*** {
    return method(this.request.headers[header], available***REMOVED***;
***REMOVED***;

  Negotiator.prototype[singular] = function(available***REMOVED*** {
    var set = this[plural](available***REMOVED***;
    if (set***REMOVED*** return set[0];
***REMOVED***;
}***REMOVED***
