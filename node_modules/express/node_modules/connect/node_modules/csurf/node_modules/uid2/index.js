/**
 * Module dependencies
 */

var crypto = require('crypto'***REMOVED***;

/**
 * 62 characters in the ascii range that can be used in URLs without special
 * encoding.
 */
var UIDCHARS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';

/**
 * Make a Buffer into a string ready for use in URLs
 *
 * @param {String}
 * @returns {String}
 * @api private
 */
function tostr(bytes***REMOVED*** {
  var chars, r, i;

  r = [];
  for (i = 0; i < bytes.length; i++***REMOVED*** {
    r.push(UIDCHARS[bytes[i] % UIDCHARS.length]***REMOVED***;
***REMOVED***

  return r.join(''***REMOVED***;
}

/**
 * Generate an Unique Id
 *
 * @param {Number} length  The number of chars of the uid
 * @param {Number} cb (optional***REMOVED***  Callback for async uid generation
 * @api public
 */

function uid(length, cb***REMOVED*** {

  if (typeof cb === 'undefined'***REMOVED*** {
    return tostr(crypto.pseudoRandomBytes(length***REMOVED******REMOVED***;
***REMOVED*** else {
    crypto.pseudoRandomBytes(length, function(err, bytes***REMOVED*** {
       if (err***REMOVED*** return cb(err***REMOVED***;
       cb(null, tostr(bytes***REMOVED******REMOVED***;
  ***REMOVED******REMOVED***
***REMOVED***
}

/**
 * Exports
 */

module.exports = uid;
