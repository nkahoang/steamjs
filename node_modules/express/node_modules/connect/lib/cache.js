
/*!
 * Connect - Cache
 * Copyright(c***REMOVED*** 2011 Sencha Inc.
 * MIT Licensed
 */

/**
 * Expose `Cache`.
 */

module.exports = Cache;

/**
 * LRU cache store.
 *
 * @param {Number} limit
 * @api private
 */

function Cache(limit***REMOVED*** {
  this.store = {};
  this.keys = [];
  this.limit = limit;
}

/**
 * Touch `key`, promoting the object.
 *
 * @param {String} key
 * @param {Number} i
 * @api private
 */

Cache.prototype.touch = function(key, i***REMOVED***{
  this.keys.splice(i,1***REMOVED***;
  this.keys.push(key***REMOVED***;
};

/**
 * Remove `key`.
 *
 * @param {String} key
 * @api private
 */

Cache.prototype.remove = function(key***REMOVED***{
  delete this.store[key];
};

/**
 * Get the object stored for `key`.
 *
 * @param {String} key
 * @return {Array}
 * @api private
 */

Cache.prototype.get = function(key***REMOVED***{
  return this.store[key];
};

/**
 * Add a cache `key`.
 *
 * @param {String} key
 * @return {Array}
 * @api private
 */

Cache.prototype.add = function(key***REMOVED***{
  // initialize store
  var len = this.keys.push(key***REMOVED***;

  // limit reached, invalidate LRU
  if (len > this.limit***REMOVED*** this.remove(this.keys.shift(***REMOVED******REMOVED***;

  var arr = this.store[key] = [];
  arr.createdAt = new Date;
  return arr;
};
