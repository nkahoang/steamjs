var http = require("http"***REMOVED***,
    fs = require("fs"***REMOVED***;

function prettyCurrentTime(***REMOVED*** {
    var date = new Date(***REMOVED***;
    return date.toLocaleString(***REMOVED***;
}

function write_file(commands, path***REMOVED*** {
    var file_contents, out_commands;

    console.log("Writing " + Object.keys(commands***REMOVED***.length + " commands to " + path***REMOVED***;

    file_contents = "// This file was generated by ./generate_commands.js on " + prettyCurrentTime(***REMOVED*** + "\n";

    out_commands = Object.keys(commands***REMOVED***.map(function (key***REMOVED*** {
        return key.toLowerCase(***REMOVED***;
  ***REMOVED******REMOVED***;

    file_contents += "module.exports = " + JSON.stringify(out_commands, null, "    "***REMOVED*** + ";\n";

    fs.writeFile(path, file_contents***REMOVED***;
}

http.get({host: "redis.io", path: "/commands.json"}, function (res***REMOVED*** {
    var body = "";

    console.log("Response from redis.io/commands.json: " + res.statusCode***REMOVED***;

    res.on('data', function (chunk***REMOVED*** {
        body += chunk;
  ***REMOVED******REMOVED***;

    res.on('end', function (***REMOVED*** {
        write_file(JSON.parse(body***REMOVED***, "lib/commands.js"***REMOVED***;
  ***REMOVED******REMOVED***;
}***REMOVED***.on('error', function (e***REMOVED*** {
    console.log("Error fetching command list from redis.io: " + e.message***REMOVED***;
}***REMOVED***;
