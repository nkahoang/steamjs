// Read a file from disk, store it in Redis, then read it back from Redis.

var redis = require("redis"***REMOVED***,
    client = redis.createClient(***REMOVED***,
    fs = require("fs"***REMOVED***,
    filename = "kids_in_cart.jpg";

// Get the file I use for testing like this:
//    curl http://ranney.com/kids_in_cart.jpg -o kids_in_cart.jpg
// or just use your own file.

// Read a file from fs, store it in Redis, get it back from Redis, write it back to fs.
fs.readFile(filename, function (err, data***REMOVED*** {
    if (err***REMOVED*** throw err
    console.log("Read " + data.length + " bytes from filesystem."***REMOVED***;
    
    client.set(filename, data, redis.print***REMOVED***; // set entire file
    client.get(filename, function (err, reply***REMOVED*** { // get entire file
        if (err***REMOVED*** {
            console.log("Get error: " + err***REMOVED***;
      ***REMOVED*** else {
            fs.writeFile("duplicate_" + filename, reply, function (err***REMOVED*** {
                if (err***REMOVED*** {
                    console.log("Error on write: " + err***REMOVED***
              ***REMOVED*** else {
                    console.log("File written."***REMOVED***;
              ***REMOVED***
                client.end(***REMOVED***;
          ***REMOVED******REMOVED***;
      ***REMOVED***
  ***REMOVED******REMOVED***;
}***REMOVED***;
